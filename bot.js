// --- tiny health server for Render ---
const http = require('http');
const PORT = process.env.PORT || 10000;
http.createServer((req, res) => { res.writeHead(200,{'Content-Type':'text/plain'}); res.end('OK'); }).listen(PORT, () => console.log(`âœ… Health server on ${PORT}`));
// --- end tiny health server ---

// ===== CircleBot (CommonJS) =====
// ãƒ­ã‚°ã‚’ç´°ã‹ãå‡ºã™ã®ã§ã€ã©ã“ã§æ­¢ã¾ã£ã¦ã„ã‚‹ã‹åˆ†ã‹ã‚Šã¾ã™ã€‚
console.log("Boot: starting bot.js");

const { Client, GatewayIntentBits, EmbedBuilder } = require('discord.js');
console.log("Boot: discord.js loaded");

require('dotenv').config();
console.log("Boot: dotenv loaded");

// .env ã‹ã‚‰èª­ã¿è¾¼ã¿
const TOKEN = process.env.DISCORD_TOKEN;
const CHANNEL_ID = process.env.CHANNEL_ID;

if (!TOKEN) {
  console.error("âŒ DISCORD_TOKEN ãŒ .env ã«ã‚ã‚Šã¾ã›ã‚“ã€‚");
  process.exit(1);
}
if (!CHANNEL_ID) {
  console.error("âŒ CHANNEL_ID ãŒ .env ã«ã‚ã‚Šã¾ã›ã‚“ã€‚");
  process.exit(1);
}

const client = new Client({ intents: [GatewayIntentBits.Guilds] });
console.log("Boot: client created");

client.once('ready', async () => {
  console.log(`âœ… Logged in as ${client.user.tag}`);

  try {
    const channel = await client.channels.fetch(CHANNEL_ID);
    if (!channel) {
      console.error("âŒ ãƒãƒ£ãƒ³ãƒãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚CHANNEL_IDã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚");
      return;
    }
    console.log("âœ… Channel fetched:", CHANNEL_ID);

    const embed1 = new EmbedBuilder()
      .setColor(0x5865f2)
      .setTitle("ğŸ“– ã‚µãƒ¼ã‚¯ãƒ«è¦ç´„ï¼ˆæ¦‚è¦ï¼‰")
      .setDescription(
`â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Œ **ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤ã«é–¢ã—ã¦**
å­¦ãƒã‚¹ãŠã‚ˆã³ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã‚’ç¶™ç¶šã—ã¦ãƒ—ãƒ¬ã‚¤ã™ã‚‹ã“ã¨ã‚’åŸå‰‡ã¨ã—ã¾ã™ã€‚  
åŸºæº–ã¨ã—ã¦ã€æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³ãŒ **3æ—¥ä»¥å†…** ã§ã‚ã‚‹çŠ¶æ…‹ã‚’ç¶­æŒã—ã¦ãã ã•ã„ã€‚  

ã‚„ã‚€ã‚’å¾—ãªã„äº‹æƒ…ã§ä¸€æ™‚çš„ã«ãƒ—ãƒ¬ã‚¤ã‚’ç¶šã‘ã‚‹ã“ã¨ãŒé›£ã—ã„å ´åˆã¯ã€  
äº‹å‰ã«ã”é€£çµ¡ã‚’ã„ãŸã ã‘ã‚Œã°å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚  

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ—£ï¸ **ã‚µãƒ¼ã‚¯ãƒ«å†…ã§ã®æ´»å‹•ã«ã¤ã„ã¦**
â€¢ ä»–è€…ã‚’å‘ä¸‹ãƒ»ä¾®è¾±ã™ã‚‹è¡Œç‚ºã€ã¾ãŸã¯ç¤¾ä¼šé€šå¿µä¸Šä¸é©åˆ‡ã¨ã¿ãªã•ã‚Œã‚‹è¨€å‹•  
ã€€ï¼ˆä¾‹ï¼šç¤¼ç¯€ã‚’æ¬ ãç™ºè¨€ãªã©ï¼‰ã‚’ç¦æ­¢ã—ã¾ã™ã€‚  
ã€€è©²å½“ã™ã‚‹è¡Œç‚ºãŒç¢ºèªã•ã‚ŒãŸå ´åˆã«ã¯ **è­¦å‘Š** ã‚’è¡Œã„ã¾ã™ã€‚  
ã€€æ”¹å–„ãŒèªã‚ã‚‰ã‚Œãªã„å ´åˆã«ã¯ **é™¤åå‡¦åˆ†** ã¨ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚  

â€¢ ã‚³ãƒ³ãƒ†ã‚¹ãƒˆç·¨æˆãªã©ã®è­°è«–å†…å®¹ã¯ã€  
ã€€**ç™ºæ¡ˆè€…ã®æ‰¿è«¾ãªã—ã«å¤–éƒ¨ã¸å…¬é–‹ã™ã‚‹ã“ã¨ã‚’ç¦æ­¢** ã—ã¾ã™ã€‚`
      );

    const embed2 = new EmbedBuilder()
      .setColor(0x5865f2)
      .setTitle("ğŸ¤ ææºã‚µãƒ¼ã‚¯ãƒ«ã«ã¤ã„ã¦ï¼ˆãƒã‚±ãƒƒãƒˆæ•™å›£ï¼‰ãƒ»ğŸ“® ç›®å®‰ç®±")
      .setDescription(
`â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ¤ **ææºã‚µãƒ¼ã‚¯ãƒ«ã«ã¤ã„ã¦ï¼ˆãƒã‚±ãƒƒãƒˆæ•™å›£ï¼‰**
å½“ã‚µãƒ¼ã‚¯ãƒ«ã§ã¯ã€ä¸»ã«æƒ…å ±äº¤æ›ãŠã‚ˆã³äº¤æµä¿ƒé€²ã‚’ç›®çš„ã¨ã—ã¦ã€  
ã‚µãƒ¼ã‚¯ãƒ«ã€Œãƒã‚±ãƒƒãƒˆæ•™å›£ã€ã¨ææºã—ã€å…±æœ‰ã‚µãƒ¼ãƒãƒ¼ã‚’é‹å–¶ã—ã¦ã„ã¾ã™ã€‚  
åŒã‚µãƒ¼ã‚¯ãƒ«ã¨ã¯éå»ã«ã‚ªãƒ•ä¼šç­‰ã§é¢è­˜ãŒã‚ã‚Šã€  
å½“ã‚µãƒ¼ã‚¯ãƒ«ã¨ä¸€å®šã®äº¤æµé–¢ä¿‚ã‚’æœ‰ã™ã‚‹ææºå›£ä½“ã§ã™ã€‚  

ğŸ“ **ã€åˆåŒã‚µãƒ¼ãƒãƒ¼URLã€‘**  
â¡ï¸ [ã‚µãƒ¼ãƒãƒ¼ã«å‚åŠ ã™ã‚‹](https://discord.gg/BhA3PWd4)

æœ¬ã‚µãƒ¼ãƒãƒ¼ã¸ã®å‚åŠ ã¯ä»»æ„ã¨ã—ã¾ã™ãŒã€ä»¥ä¸‹ã®è¦å‰‡ã‚’éµå®ˆã—ã¦ãã ã•ã„ã€‚  

â€¢ **ç™ºè¨€ã«ã¯ç´°å¿ƒã®æ³¨æ„ã‚’æ‰•ã£ã¦ãã ã•ã„ã€‚**  
ã€€ä¸ç”¨æ„ãªç™ºè¨€ã«ã‚ˆã‚Šã€ã‚µãƒ¼ã‚¯ãƒ«å…¨ä½“ãŒä¸åˆ©ç›Šã‚’è¢«ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚  

â€¢ **è©²å½“ã‚µãƒ¼ãƒãƒ¼ã«èµ·å› ã™ã‚‹æƒ…å ±ã®å¤–éƒ¨æµå‡ºã¯å³ç¦** ã¨ã—ã¾ã™ã€‚  
ã€€â€»ãŸã ã—ã€å…¬å¼ã‚µãƒ¼ãƒãƒ¼ã§æ—¢ã«å…¬é–‹ã•ã‚Œã¦ã„ã‚‹æƒ…å ±ã¯ã“ã®é™ã‚Šã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚  

â€¢ å½“ã‚µãƒ¼ãƒãƒ¼ã«é–¢ã™ã‚‹ç–‘å•ã‚„ä¸æ˜ç‚¹ãŒã‚ã‚‹å ´åˆã¯ã€  
ã€€**å¿…ãšé‹å–¶é™£ã«è¨±å¯ã¾ãŸã¯ç¢ºèªã‚’å–ã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚**  

ğŸ’¡ ç¯€åº¦ã‚’ä¿ã¡ã€åŒæ–¹ã®ã‚µãƒ¼ã‚¯ãƒ«ãŒè‰¯å¥½ãªé–¢ä¿‚ã‚’ç¯‰ã‘ã‚‹ã‚ˆã†ã”å”åŠ›ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚  

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“® **ç›®å®‰ç®±ã®è¨­ç½®**
ãƒ¡ãƒ³ãƒãƒ¼ã¨é‹å–¶é™£ã¨ã®å††æ»‘ãªæ„è¦‹äº¤æ›ã‚’ç›®çš„ã¨ã—ã¦ã€ç›®å®‰ç®±ã‚’è¨­ç½®ã—ã¦ã„ã¾ã™ã€‚  

ğŸ”¹ **ä¸»ãªç”¨é€”**
ãƒ»æ–°è¦ãƒãƒ£ãƒ³ãƒãƒ«è¨­ç«‹é¡˜ã„  
ãƒ»ã‚µãƒ¼ã‚¯ãƒ«é‹ç”¨ã«é–¢ã™ã‚‹å¤‰æ›´é¡˜ã„  
ãƒ»é‹å–¶é™£ã®å¤‰æ›´é¡˜ã„ï¼ˆé€£åã«ã‚ˆã‚‹ä¸ä¿¡ä»»æ±ºè­°ç­‰ã®æå‡ºï¼‰  
ãƒ»ãƒ¡ãƒ³ãƒãƒ¼é–“ã®ä»²è£é¡˜ã„ã€€ãªã©  

æŠ•ç¨¿ã¯åŒ¿ååŒ–ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆå¸Œæœ›ã«ã‚ˆã‚Šåç¾©è¨˜è¼‰ã‚‚å¯ï¼‰ã§é€ä¿¡ã•ã‚Œã€  
æŠ•ç¨¿è€…ãŒç‰¹å®šã•ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚  

å†…å®¹ã¯é‹å–¶é™£ã§æ…é‡ã«æ¤œè¨ã•ã‚Œã€å¿…è¦ã«å¿œã˜ã¦åæ˜ ã¾ãŸã¯ã€é€£çµ¡ã€‘ãƒãƒ£ãƒ³ãƒãƒ«ã§å…±æœ‰ã•ã‚Œã¾ã™ã€‚  
ï¼ˆâ€»ã™ã¹ã¦ã®ææ¡ˆãŒå¿…ãšæ¡ç”¨ã•ã‚Œã‚‹ã¨ã¯é™ã‚Šã¾ã›ã‚“ã€‚ï¼‰  

ğŸ“ å¥å…¨ã§ä¸­ç«‹çš„ãªé‹å–¶ã®ãŸã‚ã«ã€ãœã²ã”æ´»ç”¨ãã ã•ã„ã€‚  

ğŸ“ **ã€ç›®å®‰ç®±URLã€‘**  
â¡ï¸ [åŒ¿åãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã](https://forms.gle/1MEz7F1wE1NSaWwL8)`
      );

    await channel.send({ embeds: [embed1, embed2] });
    console.log("âœ… ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã—ãŸï¼");
  } catch (err) {
    console.error("âŒ é€ä¿¡ä¸­ã‚¨ãƒ©ãƒ¼:", err);
  }
});

client.login(TOKEN).catch(err => {
  console.error("âŒ ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—:", err);
});
